--  CRIANDO BANCO DE DADOS

create database if not exists SistemaDeAvaliacao
	character set latin1
    collate latin1_general_cs

-- CRIANDO TABELAS

-- '0' = Não e '1' = Sim --> isso para os atributos blob/tinyint(1)

create table Configuracao (
	IdConfiguracao int not null auto_increment,
    Paginacao int,
    OcultaQuestoesOutrosUsuarios tinyint(1),
    ExibeMateria tinyint(1),
    ExibeAlternativas tinyint(1),
    primary key (IdConfiguracao)
);

create table Usuario (
	IdUsuario int not null auto_increment,
    Email varchar(255),
    NomeCompleto varchar(255) not null,
    Senha char(12) not null,
    Foto tinyint(1),
    Administrador tinyint(1),
    primary key (IdUsuario)
);

create table Questao (
	IdQuestao int not null auto_increment,
    Imagem tinyint(1),
    Comentarios text,
    Assunto varchar(255),
    Ano year, 
    Banca varchar(255),
    Orgao varchar(255),
    Prova int, -- numero da prova
    Enunciado text,
    Verficada tinyint(1),
    primary key (IdQuestao)
);

create table Alternativa (
	IdAlternativa int not null auto_increment,
    Texto varchar (1000),
    Certa tinyint(4), -- 'a' = '0', 'b' = '1', 'c' = '2', 'd' = '3', 'e' = '4'
    Imagem tinyint(1),
    primary key (IdAlternativa)
);

create table Prova (
	IdProva int not null auto_increment,
    Descricao varchar(2000),
    Tema varchar(1000),
    DataProva datetime,
    primary key (IdProva)
);

create table Materia (
	IdMateria int not null auto_increment,
    Nome varchar(255),
    Sigla varchar(10),
    Curso varchar(255),
    Inativa tinyint(1),
    primary key (IdMateria)
);

-- ADICIONANDO COLUNAS

alter table Usuario
	add column IdConfiguracao int not null;

alter table Questao
	add column IdUsuario int not null;
    
alter table Alternativa
	add column IdQuestao int not null;

alter table Prova
	add column IdUsuario int not null,
    add column IdMateria int not null;

-- ADICIONANDO CHAVES ESTRANGEIRAS 

alter table Usuario
add 
foreign key (IdConfiguracao)
references Configuracao (IdConfiguracao);

alter table Questao
add 
foreign key (IdUsuario)
references Usuario (IdUsuario);

alter table Alternativa
add
foreign key (IdQuestao)
references Questao (IdQuestao);

alter table Prova
add
foreign key (IdUsuario)
references Usuario (IdUsuario);

alter table Prova
add
foreign key (IdMateria)
references Materia(IdMateria);

--  CRIANDO TABELA PROPRIA

create table ProvaQuestao(
	IdQuestao int not null,
    IdProva int not null,
    primary key (IdQuestao, IdProva),
	foreign key (IdQuestao) references Questao (IdQuestao),
	foreign key (IdProva) references Prova (IdProva)
);

-- INSERINDO DADOS
	
insert into Configuracao (Paginacao, OcultaQuestoesOutrosUsuarios, ExibeMateria, ExibeAlternativas)
values
(21, 1, 1, 1),
(21, 1, 0, 1),
(21, 0, 1, 1);

insert into Usuario (IdConfiguracao, Email, NomeCompleto, Senha, Foto, Administrador)
values
(1, "brunomotta@gmail.com", "Bruno Motta da Silva", "1234", 0, 0),
(2, "leonardomotta@yahoo.com", "Leonardo Motta da Silva", "abcd", 1, 0),
(3, "jairbolsonaro2026@hotmail.com", "Jair Bolsonaro da Silva Cabral Vieira Nascimento II", "123abc", 1, 0);

insert into Materia (Nome, Sigla, Curso, Inativa)
values
("Biologia", "BIO", ".M", 0),
("Laboratório de Programção", "LBP", "DS", 0),
("Química", "QUI", "EM", 0),
("Matemática", "MAT", "EM", 0),
("Banco de Dados", "BDD", "DS", 0);

insert into Prova (Descricao, Tema, DataProva, IdUsuario, IdMateria)
values
("Lorem ipsum dolor sit amet, consectetur adipiscing elit.", "La ele e gírias", '2025-10-10 10:15:30', 1, 1),
("Lorem ipsum dolor sit amet, consectetur adipiscing elit.", "Motta e piadas", '2025-10-10 10:15:31', 2, 2),
("Lorem ipsum dolor sit amet, consectetur adipiscing elit.", "França e o comunismo", '2025-10-10 10:15:32', 3, 3),
("Lorem ipsum dolor sit amet, consectetur adipiscing elit.", "Tamanhos diferentes de plug(in)", '2025-10-10 10:15:33', 1, 4),
("Lorem ipsum dolor sit amet, consectetur adipiscing elit.", "BOlsonaro e Lula - a luta indomável", '2025-10-10 10:15:34', 2, 5),
("Lorem ipsum dolor sit amet, consectetur adipiscing elit.", "Adriano Ricardo", '2025-10-10 10:15:35', 3, 4),
("Lorem ipsum dolor sit amet, consectetur adipiscing elit.", "Cardiar e Muscular", '2025-10-10 10:15:36', 2, 3);








    
    
